<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/H%20.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"simon-yian.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta property="og:type" content="article">
<meta property="og:title" content="Spring知识点梳理：">
<meta property="og:url" content="https://simon-yian.github.io/2021/11/27/SpringFrame/index.html">
<meta property="og:site_name" content="simon·yian&#39;Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/11/15/vKFjo15HqAybLmE.png">
<meta property="article:published_time" content="2021-11-27T06:50:20.000Z">
<meta property="article:modified_time" content="2022-06-27T13:25:48.000Z">
<meta property="article:author" content="simon·yi an">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/11/15/vKFjo15HqAybLmE.png">


<link rel="canonical" href="https://simon-yian.github.io/2021/11/27/SpringFrame/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://simon-yian.github.io/2021/11/27/SpringFrame/","path":"2021/11/27/SpringFrame/","title":"Spring知识点梳理："}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Spring知识点梳理： | simon·yian'Blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>


  <!-- 添加萝莉-->
  <script src="/live2d-widget/autoload.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">simon·yian'Blog</h1>
      <i class="logo-line"></i>
    </a>
      <img class="custom-logo-image" src="/images/simon.png" alt="simon·yian'Blog">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-message"><a href="/message/" rel="section"><i class="fas fa-comment fa-fw"></i>留言板</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring%E7%9F%A5%E8%AF%86%E7%82%B9%E6%A2%B3%E7%90%86%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">Spring知识点梳理：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%BC%80%E3%80%81spring%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="nav-number">1.1.</span> <span class="nav-text">⼀、spring的基本知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%A6%82%E4%BD%95%E4%BD%BF%E2%BD%A4Ioc%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0Bean%E7%9A%84%E8%A3%85%E9%85%8D%E3%80%82"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.如何使⽤Ioc技术实现Bean的装配。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E4%BD%BF%E2%BD%A4%E7%B1%BB%E4%B8%AD%E5%AE%9A%E4%B9%89%E7%9A%84%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84%E6%9E%84%E9%80%A0%E2%BD%85%E6%B3%95%E6%9D%A5%E5%88%9B%E5%BB%BAbean"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.使⽤类中定义的带参数的构造⽅法来创建bean</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%88%A9%E2%BD%A4getter-setter%E2%BD%85%E6%B3%95%E6%9D%A5%E9%85%8D%E7%BD%AEbean"><span class="nav-number">1.1.3.</span> <span class="nav-text">2.利⽤getter&#x2F;setter⽅法来配置bean:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E4%BD%BF%E2%BD%A4%E6%B3%A8%E8%A7%A3%E7%9A%84%E2%BD%85%E5%BC%8F%E6%9D%A5%E5%AE%9E%E7%8E%B0%EF%BC%9A"><span class="nav-number">1.1.4.</span> <span class="nav-text">3.使⽤注解的⽅式来实现：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81MyBatis%E7%9A%84%E5%BA%94%E2%BD%A4"><span class="nav-number">2.</span> <span class="nav-text">三、MyBatis的应⽤</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8F%92%E2%BC%8A%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE"><span class="nav-number">3.</span> <span class="nav-text">插⼊测试数据</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Global-logging-configuration"><span class="nav-number">4.</span> <span class="nav-text">Global logging configuration</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MyBatis-logging-configuration"><span class="nav-number">5.</span> <span class="nav-text">MyBatis logging configuration</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Console-output%E2%80%A6"><span class="nav-number">6.</span> <span class="nav-text">Console output…</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="simon·yi an"
      src="/images/avator.jpg">
  <p class="site-author-name" itemprop="name">simon·yi an</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/simon-yian" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;simon-yian" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yourname@gmail.com" title="E-Mail → mailto:yourname@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/yourname" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/yourname" title="Google → https:&#x2F;&#x2F;plus.google.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i>Google</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/yourname" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



        </div><div>
  <canvas id="canvasDiyBlock" style="width:60%;">当前浏览器不支持canvas，请更换浏览器后再试</canvas><script src="/js/custom/clock.js"></script>
</div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://simon-yian.github.io/2021/11/27/SpringFrame/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avator.jpg">
      <meta itemprop="name" content="simon·yi an">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="simon·yian'Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Spring知识点梳理：
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-11-27 14:50:20" itemprop="dateCreated datePublished" datetime="2021-11-27T14:50:20+08:00">2021-11-27</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-06-27 21:25:48" itemprop="dateModified" datetime="2022-06-27T21:25:48+08:00">2022-06-27</time>
      </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>54k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>49 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
         <img src="https://i.loli.net/2021/11/15/vKFjo15HqAybLmE.png" align="center" width="600" height="400" div>


<span id="more"></span>

<h1 id="Spring知识点梳理："><a href="#Spring知识点梳理：" class="headerlink" title="Spring知识点梳理："></a>Spring知识点梳理：</h1><h2 id="⼀、spring的基本知识"><a href="#⼀、spring的基本知识" class="headerlink" title="⼀、spring的基本知识"></a>⼀、spring的基本知识</h2><p>官⽹地址：Spring | Home</p>
<h3 id="1-如何使⽤Ioc技术实现Bean的装配。"><a href="#1-如何使⽤Ioc技术实现Bean的装配。" class="headerlink" title="1.如何使⽤Ioc技术实现Bean的装配。"></a>1.如何使⽤Ioc技术实现Bean的装配。</h3><p>第⼀步，下载对应的Spring Framework包<br>spring.io–&gt;选择 Projects –&gt;Spring Framework –&gt;点击超链接<br>GitHub - spring-projects/spring-framework: Spring Framework<br>在打开的⻚⾯中 查找 Access to Binaries 并点击跳转<br>Spring Framework Artifacts · spring-projects/spring-framework Wiki · GitHub<br>在该⻚⾯中 查找 Downloading a Distribution 并 <a target="_blank" rel="noopener" href="https://repo.spring.io/">https://repo.spring.io</a>. 跳转到下载⻚⾯.<br>下载⻚⾯的地址是: Packages - repo.spring.io<br>点击步骤：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Artifactory--Artifacts</span><br><span class="line"> -release--</span><br><span class="line"> -org--</span><br><span class="line"> -springframework--</span><br><span class="line"> -spring--</span><br><span class="line"> -5.2.19.RELEASE</span><br></pre></td></tr></table></figure>

<p>在下图的画⾯中可以看到发布版本的下载路径：<br>repo.spring.io<br>通过该链接地址访问下载库<br>下载完成的事，得到⼀个压缩包，解压该包得到Spring Framework的资源包。<br>第⼀个⽂件夹 docs：<br>⽂件⽂件夹中都是相关的⽂档。<br>javadoc-api<br>kdoc-api<br>spring-framework-reference<br>第⼆个⽂件夹 libs:<br>这⾥⾯都是要⽤到的jar包，其中第个类别的jar包都有三种，分别是XXX-javadoc.jar，XXX-sources.ar，XXX-jar，<br>它们分别代表使⽤api的⽂档，源代码，⼆进制的发布版。<br>第三个⽂件夹 schema:<br>Spring Framework的结构图:<br>⼆、基础IoC案例：<br>⼆、基础IoC案例：<br>如何理解Spring容器管理Java对象，也就是说由Spring来完成Java Bean的创建⼯作。<br>创建⼀个Java Project，创建类对象Student<br>使⽤Spring的IoC技术来完成，Java对象的管理与使⽤。<br>⾸先在项⽬中新添加⼀个⽂件夹在项⽬的根⽬录下，与src⽬录平⾏。<br>然后将beans,context,core,expression，4个jar包拷⻉到该⽬录下(lib)，还要再添加⼀个commons-logging的jar<br>包。<br>接下来就可以使⽤Spring Framework技术。<br>在项⽬的src⽬录下创建applicationContext.xml配置⽂件，⽤于描述spring容器。<br>相关信息可以在下载的解压缩包中的docs⽬录中的spring-framework-reference⽬录中的pdf⽂件夹中的core.pdf<br>⽂件中查找到具体内容。<br>其中标签是定义容器中要管理的java类对象。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class Student &#123;</span><br><span class="line"> private int id;</span><br><span class="line"> private String name;</span><br><span class="line"> private String pass;</span><br><span class="line"> private int grade;</span><br><span class="line"> private Date birthday;</span><br><span class="line"> //构造⽅法</span><br><span class="line"> //get,set⽅法的创建省略</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class MyTest &#123;</span><br><span class="line"> public static void main(String[] args) &#123;</span><br><span class="line"> Student stu1 = new Student(1001,&quot;⽻⽣结弦&quot;,&quot;2022winter&quot;,3,new Date());</span><br><span class="line"> System.out.println(stu1);</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line"> xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"> xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line"> https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;</span><br><span class="line"> </span><br><span class="line"> &lt;bean id=&quot;stu1&quot; class=&quot;com.lz.xbmu.Student&quot;&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>通过两种⽅式可以创建容器的上下⽂:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class MySpringTest &#123;</span><br><span class="line"> public static void main(String[] args) &#123;</span><br><span class="line"> //⾸先要找到spring容器</span><br><span class="line"> ApplicationContext context = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</span><br><span class="line"> System.out.println(context);</span><br><span class="line"> // 通过Spring容器使⽤getBean()⽅法就可以获取到相关的对象实例</span><br><span class="line"> Student stu1 = (Student) context.getBean(&quot;stu1&quot;);</span><br><span class="line"> System.out.println(stu1);</span><br><span class="line"> &#125; &#125; </span><br></pre></td></tr></table></figure>
<p>在Spring的配置⽂件中配置相关的bean:</p>
<h3 id="1-使⽤类中定义的带参数的构造⽅法来创建bean"><a href="#1-使⽤类中定义的带参数的构造⽅法来创建bean" class="headerlink" title="1.使⽤类中定义的带参数的构造⽅法来创建bean"></a>1.使⽤类中定义的带参数的构造⽅法来创建bean</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line"> xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"> xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line"> https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;</span><br><span class="line"> </span><br><span class="line"> &lt;bean id=&quot;stu1&quot; class=&quot;com.lz.xbmu.Student&quot;&gt;</span><br><span class="line"> &lt;constructor-arg index=&quot;0&quot; value=&quot;10011&quot; /&gt;</span><br><span class="line"> &lt;constructor-arg index=&quot;1&quot; value=&quot;⾕爱凌&quot; /&gt;</span><br><span class="line"> &lt;constructor-arg index=&quot;2&quot; value=&quot;123321&quot; /&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>在这⾥需要注意，bean中指定的参数要与构造⽅法的参数个数相匹配。上⾯的配置就要与下⾯的构造⽅法相匹配。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public Student(int id,String name,String pass) &#123;</span><br><span class="line"> this.id = id;</span><br><span class="line"> this.name = name;</span><br><span class="line"> this.pass = pass;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-利⽤getter-setter⽅法来配置bean"><a href="#2-利⽤getter-setter⽅法来配置bean" class="headerlink" title="2.利⽤getter/setter⽅法来配置bean:"></a>2.利⽤getter/setter⽅法来配置bean:</h3><p>使⽤该试可以⾃由的指定要配置的属性值。</p>
<h3 id="3-使⽤注解的⽅式来实现："><a href="#3-使⽤注解的⽅式来实现：" class="headerlink" title="3.使⽤注解的⽅式来实现："></a>3.使⽤注解的⽅式来实现：</h3><p>注意使⽤注解的⽅式时，因为使⽤了AOP的机制，所以需要再导⼊spring-aop相关的jar包。<br>spring-aop-5.2.18.RELEASE.jar，并且将该包添加到build path路径中去。<br>Spring AOP<br>AOP的全称是Aspect-Oriented Programming，即⾯向切⾯编程（也称⾯向⽅⾯编程）。它是⾯向对象编程<br>（OOP）的⼀种补充，⽬前已成为⼀种⽐较成熟的编程⽅式。<br>虽然AOP是⼀种新的编程思想，但却不是OOP的替代品，它只是OOP的延伸和补充。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;stu2&quot; class=&quot;com.lz.xbmu.Student&quot;&gt;</span><br><span class="line"> &lt;property name=&quot;id&quot; value=&quot;10012&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;property name=&quot;name&quot; value=&quot;苏御明&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;property name=&quot;pass&quot; value=&quot;111111&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;property name=&quot;grade&quot; value=&quot;3&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;property name=&quot;birthday&quot; value=&quot;Thu Mar 03 11:18:42 CST 2022&quot;&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Component(value=&quot;stu3&quot;) //添加注解,并且给类定义名称为stu3</span><br><span class="line">public class Student &#123;</span><br><span class="line"> private int id;</span><br><span class="line"> private String name;</span><br><span class="line"> private String pass;</span><br><span class="line"> private int grade;</span><br><span class="line"> private Date birthday;</span><br><span class="line"> //其他内容略，与前⾯的类定义⼀致</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line"> xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"> xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line"> xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line"> https://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line"> http://www.springframework.org/schema/context</span><br><span class="line"> https://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;</span><br><span class="line"> </span><br><span class="line"> &lt;!-- 使⽤注解的⽅式 --&gt;</span><br><span class="line"> &lt;context:annotation-config /&gt;</span><br><span class="line"> &lt;!-- 配置⾃动扫描的包路径 --&gt;</span><br><span class="line"> &lt;context:component-scan base-package=&quot;com.lz.xbmu&quot;&gt;&lt;/context:component-scan&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>Aspect：封装的⽤于横向插⼊系统功能（如事务、⽇志等）的类<br>Joinpoint：在程序执⾏过程中的某个阶段点<br>Pointcut：切⾯与程序流程的交叉点，即那些需要处理的连接点<br>Advice（增强）：Advice 定义了在 Pointcut ⾥⾯定义的程序点具体要做的操作，它通过 before、after 和 around<br>来区别是在每个 joint point 之前、之后还是代替执⾏的代码<br>Target（⽬标对象）：织⼊ Advice 的⽬标对象<br>Weaving（织⼊）：将切⾯代码插⼊到⽬标对象上，从⽽⽣成代理对象的过程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;myAspect&quot; class=&quot;com.itheima.aspectj.xml.MyAspect&quot; /&gt;</span><br><span class="line"> &lt;aop:config&gt;</span><br><span class="line"> &lt;aop:aspect id=&quot;aspect&quot; ref=&quot;myAspect&quot;&gt;</span><br><span class="line"> &lt;aop:pointcut expression=&quot;execution(* com.itheima.jdk.*.*(..))“ id=&quot;myPointCut&quot; /&gt;</span><br><span class="line"> &lt;aop:before method=&quot;myBefore&quot; pointcut-ref=&quot;myPointCut&quot; /&gt;</span><br><span class="line"> &lt;aop:after-returning method=&quot;myAfterReturning“ pointcut-ref=&quot;myPointCut&quot; </span><br><span class="line"> returning=&quot;returnVal&quot; /&gt;</span><br><span class="line"> &lt;aop:around method=&quot;myAround&quot; pointcut-ref=&quot;myPointCut&quot; /&gt;</span><br><span class="line"> &lt;aop:after-throwing method=&quot;myAfterThrowing“ pointcut-ref=&quot;myPointCut&quot; </span><br><span class="line">throwing=&quot;e&quot; /&gt;</span><br><span class="line"> &lt;aop:after method=&quot;myAfter&quot; pointcut-ref=&quot;myPointCut&quot; /&gt;</span><br><span class="line"> &lt;/aop:aspect&gt;</span><br><span class="line"> &lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>

<p>项⽬案例⼀，基于xml的配置⽅式<br>在新建的项⽬中导⼊以下的包:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">aspectjweaver-1.9.8.jar</span><br><span class="line">commons-logging-1.2.jar</span><br><span class="line">spring-aop-5.2.19.RELEASE.jar</span><br><span class="line">spring-aspects-5.2.19.RELEASE.jar</span><br><span class="line">spring-beans-5.2.19.RELEASE.jar</span><br><span class="line">spring-context-5.2.19.RELEASE.jar</span><br><span class="line">spring-core-5.2.19.RELEASE.jar</span><br><span class="line">spring-expression-5.2.19.RELEASE.jar</span><br><span class="line">spring-tx-5.2.19.RELEASE.jar</span><br></pre></td></tr></table></figure>

<p>并将上⾯的包添加到项⽬环境中去。BuildTo–&gt;AddToBuildPath<br>1.⾸先创建业务程序<br>UserDao及实现类UserDaoImpl</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.dao;</span><br><span class="line">import com.lz.xbmu.po.User;</span><br><span class="line">public interface UserDao &#123;</span><br><span class="line"> int insertUser(User user);</span><br><span class="line"> User selectUserById(int id);</span><br><span class="line">&#125;</span><br><span class="line">package com.lz.xbmu.dao.impl;</span><br><span class="line">import com.lz.xbmu.dao.UserDao;</span><br><span class="line">import com.lz.xbmu.po.User;</span><br><span class="line">public class UserDaoImpl implements UserDao &#123;</span><br><span class="line"> @Override</span><br><span class="line"> public int insertUser(User user) &#123;</span><br><span class="line"> // TODO Auto-generated method stub</span><br><span class="line"> //有系统级的权限检查</span><br><span class="line"> System.out.println(&quot;新增⽤户⽅法执⾏...&quot;);</span><br><span class="line"> //业务执⾏完成后，需要记录⽇志</span><br><span class="line"> return 0;</span><br><span class="line"> &#125;</span><br><span class="line"> @Override</span><br><span class="line"> public User selectUserById(int id) &#123;</span><br><span class="line"> // TODO Auto-generated method stub</span><br><span class="line"> //有系统级的权限检查</span><br><span class="line"> System.out.println(&quot;根据id查找⽤户⽅法执⾏...&quot;);</span><br><span class="line"> //业务执⾏完成后，需要记录⽇志</span><br><span class="line"> return null;</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.aspect;</span><br><span class="line">import org.aspectj.lang.JoinPoint;</span><br><span class="line">//⾃定义的切⾯类，为⽬标⽅法提供增强的系统功能</span><br><span class="line">public class MyAspect &#123;</span><br><span class="line"> //前置通知</span><br><span class="line"> public void myBefore(JoinPoint joinPoint) &#123;</span><br><span class="line"> System.out.println(&quot;前置通知：模拟执⾏权限检查&quot;);</span><br><span class="line"> System.out.println(&quot;⽬标类是：&quot;+joinPoint.getTarget());</span><br><span class="line"> System.out.println(&quot;,被植⼊增强的⽬标⽅法是：&quot;+joinPoint.getSignature().getName());</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line"> xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"> xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line"> xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line"> https://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line"> http://www.springframework.org/schema/aop</span><br><span class="line"> https://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;</span><br><span class="line"> &lt;bean id=&quot;userDao&quot; class=&quot;com.lz.xbmu.dao.impl.UserDaoImpl&quot; /&gt;</span><br><span class="line"> &lt;!-- Spring AOP --&gt;</span><br><span class="line"> &lt;bean id=&quot;myAspect&quot; class=&quot;com.lz.xbmu.aspect.MyAspect&quot;/&gt;</span><br><span class="line"> &lt;aop:config&gt;</span><br><span class="line"> &lt;!-- 配置切⾯ --&gt;</span><br><span class="line"> &lt;aop:aspect ref=&quot;myAspect&quot;&gt;</span><br><span class="line"> &lt;!-- 配置切⼊点 --&gt;</span><br><span class="line"> &lt;aop:pointcut expression=&quot;execution(* com.lz.xbmu.dao.*.*(..))&quot; id=&quot;myPointCut&quot;/&gt;</span><br><span class="line"> &lt;!-- 关联通知Advice和切⼊点pointCut --&gt;</span><br><span class="line"> &lt;!-- &lt;aop:before method=&quot;myBefore&quot; pointcut-ref=&quot;myPointCut&quot;/&gt;</span><br><span class="line"> &lt;aop:after-returning method=&quot;myAfterReturning&quot;</span><br><span class="line"> pointcut-ref=&quot;myPointCut&quot; returning=&quot;returnVal&quot;/&gt;--&gt;</span><br><span class="line"> &lt;aop:around method=&quot;myAround&quot; pointcut-ref=&quot;myPointCut&quot;/&gt;</span><br><span class="line"> &lt;/aop:aspect&gt;</span><br><span class="line"> &lt;/aop:config&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu;</span><br><span class="line">import org.springframework.context.ApplicationContext;</span><br><span class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line">import com.lz.xbmu.dao.UserDao;</span><br><span class="line">import com.lz.xbmu.po.User;</span><br><span class="line">public class SpringAopTest &#123;</span><br><span class="line"> public static void main(String[] args) &#123;</span><br><span class="line"> ApplicationContext ctxt = new ClassPathXmlApplicationContext(&quot;bean.xml&quot;);</span><br><span class="line"> //System.out.println(ctxt);</span><br><span class="line"> UserDao userDao = ctxt.getBean(UserDao.class);</span><br><span class="line"> userDao.selectUserById(110);</span><br><span class="line"> User user = new User();</span><br><span class="line"> user.setUid(1001);</span><br><span class="line"> user.setUsername(&quot;Jack&quot;);</span><br><span class="line"> user.setPassword(&quot;123123&quot;);</span><br><span class="line"> //userDao.insertUser(user);</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>基于注解的AOP的配置<br>使⽤注解的myAspect</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.aspect;</span><br><span class="line">import org.aspectj.lang.JoinPoint;</span><br><span class="line">import org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line">import org.aspectj.lang.annotation.After;</span><br><span class="line">import org.aspectj.lang.annotation.AfterReturning;</span><br><span class="line">import org.aspectj.lang.annotation.Around;</span><br><span class="line">import org.aspectj.lang.annotation.Aspect;</span><br><span class="line">import org.aspectj.lang.annotation.Before;</span><br><span class="line">import org.aspectj.lang.annotation.Pointcut;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line">//⾃定义的切⾯类，为⽬标⽅法提供增强的系统功能</span><br><span class="line">@Aspect</span><br><span class="line">@Component</span><br><span class="line">public class MyAspect &#123;</span><br><span class="line"> //定义切⼊点表达式</span><br><span class="line"> @Pointcut(&quot;execution(* com.lz.xbmu.dao.*.*(..))&quot;)</span><br><span class="line"> private void myPointCut() &#123;&#125;</span><br><span class="line"> </span><br><span class="line"> //前置通知</span><br><span class="line"> //@Before(&quot;myPointCut()&quot;)</span><br><span class="line"> public void myBefore(JoinPoint joinPoint) &#123;</span><br><span class="line"> System.out.println(&quot;前置通知：模拟执⾏权限检查&quot;);</span><br><span class="line"> System.out.println(&quot;⽬标类是：&quot;+joinPoint.getTarget());</span><br><span class="line"> System.out.println(&quot;,被植⼊增强的⽬标⽅法是：&quot;+joinPoint.getSignature().getName());</span><br><span class="line"> System.out.println(&quot;,植⼊⽅法中的参数有：&quot;+joinPoint.getArgs()[0]);</span><br><span class="line"> &#125;</span><br><span class="line"> //后置通知</span><br><span class="line"> //@AfterReturning(pointcut = &quot;myPointCut()&quot;,returning=&quot;returnVal&quot;)</span><br><span class="line"> public void myAfterReturning(JoinPoint joinPoint,Object returnVal) &#123;</span><br><span class="line"> System.out.println(&quot;后置通知：模拟记录⽇志&quot;);</span><br><span class="line"> System.out.println(&quot;,被植⼊增强的⽬标⽅法是：&quot;+joinPoint.getSignature().getName());</span><br><span class="line"> System.out.println(returnVal);</span><br><span class="line"> &#125;</span><br><span class="line"> //环绕通知</span><br><span class="line"> //@Around(&quot;myPointCut()&quot;)</span><br><span class="line"> public Object myAround(ProceedingJoinPoint proceeding) throws Throwable &#123;</span><br><span class="line"> System.out.println(&quot;环绕开始：&quot;+proceeding.getTarget());</span><br><span class="line"> Object obj = proceeding.proceed(); //只有写了这名话，⽬标⽅法才会执⾏。</span><br><span class="line"> System.out.println(&quot;环绕结束：&quot;+proceeding.getSignature().getName());</span><br><span class="line"> return obj;</span><br><span class="line"> &#125;</span><br><span class="line"> //最终通知</span><br><span class="line"> @After(&quot;myPointCut()&quot;)</span><br><span class="line"> public void myAfter() &#123;</span><br><span class="line"> System.out.println(&quot;我是最终通知...&quot;);</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line"> xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"> xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;</span><br><span class="line"> xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line"> xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line"> https://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line"> http://www.springframework.org/schema/aop</span><br><span class="line"> https://www.springframework.org/schema/aop/spring-aop.xsd</span><br><span class="line"> http://www.springframework.org/schema/context</span><br><span class="line"> https://www.springframework.org/schema/context/spring-context.xsd&quot;&gt;</span><br><span class="line"> &lt;context:component-scan base-package=&quot;com.lz.xbmu&quot;&gt;&lt;/context:component-scan&gt;</span><br><span class="line"> &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<h1 id="三、MyBatis的应⽤"><a href="#三、MyBatis的应⽤" class="headerlink" title="三、MyBatis的应⽤"></a>三、MyBatis的应⽤</h1><p>Hibernate 优点 Mybatis 优点<br>1、hibernate是全⾃动，hibernate完全可以通过<br>对象关系模型实现对数据库的操作，拥有完整的<br>JavaBean对象与数据库的映射结构来⾃动⽣成<br>sql。 2、功能强⼤，数据库⽆关性好，O/R映射能<br>⼒强，需要写的代码很少，开发速度很快。 3、有<br>更好的⼆级缓存机制，可以使⽤第三⽅缓存。 4、<br>数据库移植性良好。 5、hibernate拥有完整的⽇<br>志系统，hibernate⽇志系统⾮常健全，涉及⼴<br>泛，包括sql记录、关系异常、优化警告、缓存提<br>示、脏数据警告等<br>1、易于上⼿和掌握，提供了数据库查询的⾃动对象绑<br>定功能，⽽且延续了很好的SQL使⽤经验，对于没有那<br>么⾼的对象模型要求的项⽬来说，相当完美。 2、sql<br>写在xml⾥，便于统⼀管理和优化， 解除sql与程序代<br>码的耦合。 3、提供映射标签，⽀持对象与数据库的<br>orm字段关系映射 4、 提供对象关系映射标签，⽀持对<br>象关系组建维护 5、提供xml标签，⽀持编写动态sql。 6、速度相对于Hibernate的速度较快<br>Hibernate 缺点 MyBatis 缺点<br>1、学习⻔槛⾼，精通⻔槛更⾼，程序员如何设计<br>O/R映射，在性能和对象模型之间如何取得平衡，<br>以及怎样⽤好Hibernate⽅⾯需要的经验和能⼒都<br>很强才⾏ 2、hibernate的sql很多都是⾃动⽣成<br>的，⽆法直接维护sql；虽然有hql查询，但功能还<br>是不及sql强⼤，⻅到报表等变态需求时，hql查询<br>要虚，也就是说hql查询是有局限的；hibernate<br>虽然也⽀持原⽣sql查询，但开发模式上却与orm<br>不同，需要转换思维，因此使⽤上有些不⽅便。<br>总之写sql的灵活度上hibernate不及mybatis。 1、关联表多时，字段多的时候，sql⼯作量很⼤。 2、<br>sql依赖于数据库，导致数据库移植性差。 3、由于xml<br>⾥标签id必须唯⼀，导致DAO中⽅法不⽀持⽅法重载。<br>4、对象关系映射标签和字段映射标签仅仅是对映射关<br>系的描述，具体实现仍然依赖于sql。 5、DAO层过于<br>简单，对象组装的⼯作量较⼤。 6、不⽀持级联更新、<br>级联删除。 7、Mybatis的⽇志除了基本记录功能外，<br>其它功能薄弱很多。 8、编写动态sql时,不⽅便调试，<br>尤其逻辑复杂时。 9、提供的写动态sql的xml标签功能<br>简单，编写动态sql仍然受限，且可读性低。<br>三、MyBatis的应⽤<br>1.Hibernate与MyBati之间的优点与缺点。<br>Hibernate是全⾃动的，MyBatis是半⾃动的，需要⼿动编写与维护SQL语句。<br>参考资料：Mybatis和Hibernate的区别、优缺点<br>ORM的持久化概念。<br>2.MyBatis的下载：<br>GitHub - mybatis/mybatis-3: MyBatis SQL mapper framework for Java<br>下载发⾏版的压缩包后解压，得到MyBatis的资源相关的⽂件夹。其中内容如上所示。<br>其中的mybatis-3.5.X.pdf就是帮助⽂档，其中的内容可以学习使⽤。<br>3.MyBatis的⼯作原理<br>4.MyBatis的应⽤案例<br>(1)根据客户的编号进⾏唯⼀结果的查询。<br>(2)根据客户的名称进⾏模糊查询。<br>创建名为mybatis的数据库，并在其中创建⼀个表，表名为t_customer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># create database mybatis;</span><br><span class="line">create database if not exists mybatis default charset=utf8mb4;</span><br><span class="line">use mybatis;</span><br><span class="line">show tables;</span><br><span class="line">create table if not exists t_customer(</span><br><span class="line"> id int(11) not null auto_increment,</span><br><span class="line"> username varchar(64),</span><br><span class="line"> jobs varchar(64),</span><br><span class="line"> phone varchar(11),</span><br><span class="line"> primary key (id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h1 id="插⼊测试数据"><a href="#插⼊测试数据" class="headerlink" title="插⼊测试数据"></a>插⼊测试数据</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into t_customer values (110011,&quot;刘德华&quot;,&quot;歌⼿&quot;,&quot;13909311100&quot;),(110012,&quot;周星驰&quot;,&quot;演 员&quot;,&quot;13909311111&quot;);</span><br></pre></td></tr></table></figure>

<p>创建⼀个项⽬，在项⽬中的lib⽬录下复制以下的jar包。<br>commons-logging-1.2.jar<br>log4j-1.2.17.jar<br>log4j-api-2.17.0.jar<br>mybatis-3.5.9.jar<br>但是要访问MySQL数据库，还需要jdbc的驱动包。<br>mysql-connector-java-8.0.28.jar<br>将以上的jar包添加到项⽬中去。<br>构建项⽬的内容：<br>在classpath⽬录下分别创建mybatis的⽇志配置⽂件和核⼼配置⽂件</p>
<h1 id="Global-logging-configuration"><a href="#Global-logging-configuration" class="headerlink" title="Global logging configuration"></a>Global logging configuration</h1><p>log4j.rootLogger=ERROR,stdout</p>
<h1 id="MyBatis-logging-configuration"><a href="#MyBatis-logging-configuration" class="headerlink" title="MyBatis logging configuration"></a>MyBatis logging configuration</h1><p>log4j.logger.com.lz.xbmu=DEBUG</p>
<h1 id="Console-output…"><a href="#Console-output…" class="headerlink" title="Console output…"></a>Console output…</h1><p>log4j.appender.stdout=org.apache.log4j.ConsoleAppender<br>log4j.appender.stdout.layout=org.apache.log4j.PatternLayout<br>log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line"> &lt;environments default=&quot;development&quot;&gt;</span><br><span class="line"> &lt;environment id=&quot;development&quot;&gt;</span><br><span class="line"> &lt;transactionManager type=&quot;JDBC&quot;/&gt;</span><br><span class="line"> &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line"> &lt;property name=&quot;driver&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;/&gt;</span><br><span class="line"> &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis&quot;/&gt;</span><br><span class="line"> &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;</span><br><span class="line"> &lt;property name=&quot;password&quot; value=&quot;mysqlroot&quot;/&gt;</span><br><span class="line"> &lt;/dataSource&gt;</span><br><span class="line"> &lt;/environment&gt;</span><br><span class="line"> &lt;/environments&gt;</span><br><span class="line"> &lt;mappers&gt;</span><br><span class="line"> &lt;mapper resource=&quot;com/lz/xbmu/mapper/CustomerMapper.xml&quot;/&gt;</span><br><span class="line"> &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>

<p>创建项⽬的基础包路径 com.lz.xbmu<br>并创建po包及类Customer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.po;</span><br><span class="line">public class Customer &#123;</span><br><span class="line"> private Integer id;</span><br><span class="line"> private String username;</span><br><span class="line"> private String jobs;</span><br><span class="line"> private String phone; </span><br><span class="line"> @Override</span><br><span class="line"> public String toString() &#123;</span><br><span class="line"> return &quot;Customer [id=&quot; + id + &quot;, username=&quot; + username + &quot;, jobs=&quot; + jobs + &quot;, phone=&quot; +</span><br><span class="line">phone + &quot;]&quot;;</span><br><span class="line"> &#125;</span><br><span class="line"> //getter/setter⽅法略</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>在com.lz.xbmu.mapper包中创建映射⽂件CustomerMapper.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.CustomerMapper&quot;&gt;</span><br><span class="line"> &lt;select id=&quot;findCustomerById&quot; parameterType=&quot;Integer&quot;</span><br><span class="line"> resultType=&quot;com.lz.xbmu.po.Customer&quot;&gt;</span><br><span class="line"> select * from t_customer where id = #&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

<p>在com.lz.xbmu.test包中创建测试类<br>MyBatis的核⼼配置及映射⽂件<br>SqlSessionFactory核⼼对象的理解：<br>•SqlSessionFactory对象是线程安全的，它⼀旦被创建，在整个应⽤执⾏期间都会存在。如果我们多次的创建同⼀<br>个数据库的SqlSessionFactory，那么此数据库的资源将很容易被耗尽。为此，通常每⼀个数据库都会只对应⼀个<br>SqlSessionFactory，所以在构建SqlSessionFactory实例时，建议使⽤单列模式。<br>在使⽤SqlSession对象执⾏SQL语句时，要注意commit⽅法的使⽤情况。<br>MyBatisUtils.java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.test;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">import com.lz.xbmu.po.Customer;</span><br><span class="line">public class MyBatisTest &#123;</span><br><span class="line"> public static void main(String[] args) throws IOException &#123;</span><br><span class="line"> //指定核⼼配置⽂件名称</span><br><span class="line"> String resource = &quot;mybatis-config.xml&quot;;</span><br><span class="line"> //将核⼼配置⽂件读取为流数据</span><br><span class="line"> InputStream is = Resources.getResourceAsStream(resource);</span><br><span class="line"> //创建SqlSession⼯⼚对象，使⽤读取的流及build⽅法</span><br><span class="line"> SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(is);</span><br><span class="line"> //创建SqlSession对象，⽤于执⾏⽬标语句</span><br><span class="line"> SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line"> //查询并获取结果</span><br><span class="line"> Customer customer =</span><br><span class="line">sqlSession.selectOne(&quot;com.lz.xbmu.CustomerMapper.findCustomerById&quot;,100);</span><br><span class="line"> System.out.println(customer);</span><br><span class="line"> sqlSession.close();</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.util;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">public class MyBatisUtils &#123;</span><br><span class="line"> private static SqlSessionFactory sqlSessionFactory;</span><br><span class="line"> static &#123;</span><br><span class="line"> try &#123;</span><br><span class="line"> InputStream is = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line"> sqlSessionFactory = new SqlSessionFactoryBuilder().build(is);</span><br><span class="line"> &#125; catch (IOException e) &#123;</span><br><span class="line"> // TODO Auto-generated catch block</span><br><span class="line"> e.printStackTrace();</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> //返回SqlSession对象</span><br><span class="line"> public static SqlSession getSession() &#123;</span><br><span class="line"> return sqlSessionFactory.openSession();</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>分别实现selectList,insert,delete等⽅法的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.test;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.util.List;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">import com.lz.xbmu.po.Customer;</span><br><span class="line">import com.lz.xbmu.util.MyBatisUtils;</span><br><span class="line">public class MyBatisTest &#123;</span><br><span class="line"> </span><br><span class="line"> //@Test</span><br><span class="line"> public void selectOne() throws IOException &#123;</span><br><span class="line"> </span><br><span class="line"> String resource = &quot;mybatis-config.xml&quot;;</span><br><span class="line"> InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line"> </span><br><span class="line"> SqlSessionFactory sqlSessionFactory =</span><br><span class="line"> new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line"> </span><br><span class="line"> SqlSession sqlSession = sqlSessionFactory.openSession();</span><br><span class="line"> Customer customer = sqlSession.selectOne(&quot;com.lz.xbmu.CustomerMapper.findCustomerById&quot;,1);</span><br><span class="line"> System.out.println(customer);</span><br><span class="line"> sqlSession.close();</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> //@Test</span><br><span class="line"> public void findAll() &#123;</span><br><span class="line"> SqlSession sqlSession = null;</span><br><span class="line"> try &#123;</span><br><span class="line"> String resource = &quot;mybatis-config.xml&quot;;</span><br><span class="line"> InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line"> </span><br><span class="line"> SqlSessionFactory sqlSessionFactory =</span><br><span class="line"> new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line"> </span><br><span class="line"> sqlSession = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line"> List&lt;Customer&gt; customers = sqlSession.selectList(&quot;com.lz.xbmu.CustomerMapper.findAll&quot;);</span><br><span class="line"> for(Customer c : customers) System.out.println(c);</span><br><span class="line"> &#125;catch (Exception e) &#123;</span><br><span class="line"> // TODO: handle exception</span><br><span class="line"> System.out.println(e);</span><br><span class="line"> &#125;finally &#123;</span><br><span class="line"> sqlSession.close();</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> //插⼊新数据</span><br><span class="line"> //@Test</span><br><span class="line"> public void insertCustomer() &#123;</span><br><span class="line"> SqlSession sqlSession = null;</span><br><span class="line"> try &#123;</span><br><span class="line"> String resource = &quot;mybatis-config.xml&quot;;</span><br><span class="line"> InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line"> SqlSessionFactory sqlSessionFactory =</span><br><span class="line"> new SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line"> sqlSession = sqlSessionFactory.openSession();</span><br><span class="line"> //创建要插⼊的顾客信息</span><br><span class="line"> Customer cust = new Customer();</span><br><span class="line"> cust.setUsername(&quot;刘欢&quot;);</span><br><span class="line"> cust.setJobs(&quot;歌⼿&quot;);</span><br><span class="line"> cust.setPhone(&quot;13919912345&quot;);</span><br><span class="line"> int result = sqlSession.insert(&quot;com.lz.xbmu.CustomerMapper.insertCust&quot;, cust);</span><br><span class="line"> System.out.println(&quot;插⼊数据后的结果:&quot;+result);</span><br><span class="line"> //默认把⾃动提交给关闭了，所以要⼿动提交</span><br><span class="line"> sqlSession.commit();</span><br><span class="line"> &#125;catch (Exception e) &#123;</span><br><span class="line"> // TODO: handle exception</span><br><span class="line"> System.out.println(e);</span><br><span class="line"> &#125;finally &#123;</span><br><span class="line"> sqlSession.close();</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> //删除数据</span><br><span class="line"> @Test</span><br><span class="line"> public void deleteCustomer() &#123;</span><br><span class="line"> SqlSession sqlSession = null;</span><br><span class="line"> try &#123;</span><br><span class="line"> sqlSession = MyBatisUtils.getSession();</span><br><span class="line"> //删除指定id的顾客信息</span><br><span class="line"> int result = sqlSession.delete(&quot;com.lz.xbmu.CustomerMapper.deleteById&quot;, 110017);</span><br><span class="line"> sqlSession.commit();</span><br><span class="line"> &#125;catch (Exception e) &#123;</span><br><span class="line"> // TODO: handle exception</span><br><span class="line"> e.printStackTrace();</span><br><span class="line"> &#125;finally &#123;</span><br><span class="line"> sqlSession.close();</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>核⼼配置⽂件：建议参考帮助⽂档中的内容。<br>typeHandlers<br>objectFactory<br>plugins<br>以上三个配置元素了解即可。<br>元素⽤于对环境进⾏配置。MyBatis的环境配置实际上就是数据源的配置，我们可以通过元素配置多种数据源，即<br>配置多种数据库。<br>其它的配置，请参考帮助⽂档。<br>映射⽂件的配置：<br>CustomerMapper.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.CustomerMapper&quot;&gt;</span><br><span class="line"> &lt;select id=&quot;findCustomerById&quot; parameterType=&quot;Integer&quot;</span><br><span class="line"> resultType=&quot;customer&quot;&gt;</span><br><span class="line"> select * from t_customer where id = #&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;select id=&quot;findAll&quot; resultType=&quot;customer&quot;&gt;</span><br><span class="line"> select * from t_customer</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;update id=&quot;updateCustomer&quot; parameterType=&quot;customer&quot;&gt;</span><br><span class="line"> update t_customer set username=#&#123;username&#125;,jobs=#&#123;jobs&#125;,phone=#&#123;phone&#125; where id=#&#123;id&#125;</span><br></pre></td></tr></table></figure>

<p>动态SQL<br>if的使⽤<br>当使⽤综合条件查询时，⽆法确定条件是否都存在或是可⽤，就需要if来判断条件是否可⽤。<br>choose、when、otherwise<br>当多个条件都可⽤时，依次按条件出现的顺序选择第⼀个可⽤的条件进⾏查询。如果所有条件均不满⾜，则使⽤<br>otherwise中的条件进⾏查询。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;/update&gt;</span><br><span class="line"> &lt;!-- 添加记录 --&gt;</span><br><span class="line"> &lt;insert id=&quot;insertCustomer&quot; parameterType=&quot;customer&quot;</span><br><span class="line"> useGeneratedKeys=&quot;true&quot; keyColumn=&quot;id&quot; keyProperty=&quot;id&quot;&gt;</span><br><span class="line"> &lt;selectKey&gt;&lt;/selectKey&gt;</span><br><span class="line"> insert into t_customer values (#&#123;id&#125;,#&#123;username&#125;,#&#123;jobs&#125;,#&#123;phone&#125;)</span><br><span class="line"> &lt;/insert&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"> &lt;select id=&quot;findCustomerByNameAndJobs&quot; parameterType=&quot;map&quot;</span><br><span class="line"> resultType=&quot;customer&quot;&gt;</span><br><span class="line"> select * from t_customer where 1=1</span><br><span class="line"> &lt;if test=&quot;name != null and name != &#x27;&#x27;&quot;&gt;</span><br><span class="line"> and username like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)</span><br><span class="line"> &lt;/if&gt;</span><br><span class="line"> &lt;if test=&quot;jobs != null and jobs != &#x27;&#x27;&quot;&gt;</span><br><span class="line"> and jobs=#&#123;jobs&#125;</span><br><span class="line"> &lt;/if&gt;</span><br><span class="line"> &lt;/select&gt;</span><br></pre></td></tr></table></figure>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void findCustomerByNameAndJobs() &#123;</span><br><span class="line">SqlSession sqlSession = MyBatisUtils.getSession();</span><br><span class="line">Map&lt;String,String&gt; map = new HashMap&lt;&gt;();</span><br><span class="line">map.put(&quot;name&quot;, &quot;t&quot;);</span><br><span class="line">map.put(&quot;jobs&quot;,&quot;Farmer&quot;);</span><br><span class="line">List&lt;Customer&gt; custs = sqlSession</span><br><span class="line">.selectList(&quot;com.lz.xbmu.CustomerMapper.findCustomerByNameAndJobs&quot;,map);</span><br><span class="line">for(Customer c : custs) System.out.println(c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &lt;select id=&quot;findCustomerByNameAndJobs&quot; parameterType=&quot;map&quot;</span><br><span class="line"> resultType=&quot;customer&quot;&gt;</span><br><span class="line"> select * from t_customer where 1=1</span><br><span class="line"> &lt;choose&gt;</span><br><span class="line"> &lt;when test=&quot;name != null and name != &#x27;&#x27;&quot;&gt;</span><br><span class="line"> and username like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)</span><br><span class="line">trim、where、set</span><br></pre></td></tr></table></figure>


<p>⽤于处理较特殊的情况，例如去除where 1=1这种情况<br>会⾃动判断后⾯的条件是否成⽴，如果成⽴则添加where条件，并且⾃动处理and或or关键字。<br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> &lt;/when&gt;</span><br><span class="line">&lt;when test=&quot;jobs != null and jobs != &#x27;&#x27;&quot;&gt;</span><br><span class="line">and jobs=#&#123;jobs&#125;</span><br><span class="line">&lt;/when&gt;</span><br><span class="line">&lt;otherwise&gt;</span><br><span class="line">and phone is not null</span><br><span class="line">&lt;/otherwise&gt;</span><br><span class="line">&lt;/choose&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line"> public void findCustomerByNameAndJobs1() &#123;</span><br><span class="line"> SqlSession sqlSession = MyBatisUtils.getSession();</span><br><span class="line"> Map&lt;String,String&gt; map = new HashMap&lt;&gt;();</span><br><span class="line"> //map.put(&quot;name&quot;, &quot;t&quot;);</span><br><span class="line"> //map.put(&quot;jobs&quot;,&quot;Farmer&quot;);</span><br><span class="line"> List&lt;Customer&gt; custs = sqlSession</span><br><span class="line"> .selectList(&quot;com.lz.xbmu.CustomerMapper.findCustomerByNameAndJobs&quot;,map);</span><br><span class="line"> for(Customer c : custs) System.out.println(c);</span><br><span class="line"> &#125;</span><br><span class="line"> &lt;select id=&quot;findCustomerByNameAndJobs1&quot; parameterType=&quot;map&quot;</span><br><span class="line"> resultType=&quot;customer&quot;&gt;</span><br><span class="line"> select * from t_customer</span><br><span class="line"> &lt;where&gt;</span><br><span class="line"> &lt;if test=&quot;name != null and name != &#x27;&#x27;&quot;&gt;</span><br><span class="line"> username like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)</span><br><span class="line"> &lt;/if&gt;</span><br><span class="line"> &lt;if test=&quot;jobs != null and jobs != &#x27;&#x27;&quot;&gt;</span><br><span class="line"> and jobs=#&#123;jobs&#125;</span><br><span class="line"> &lt;/if&gt;</span><br><span class="line"> &lt;/where&gt;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;update id=&quot;updateCustomer&quot; parameterType=&quot;customer&quot;&gt;</span><br><span class="line"> update t_customer</span><br><span class="line"> &lt;set&gt;</span><br><span class="line"> &lt;if test=&quot;username != null and username != &#x27;&#x27;&quot;&gt;</span><br><span class="line"> username=#&#123;username&#125;,</span><br><span class="line"> &lt;/if&gt;</span><br><span class="line"> &lt;if test=&quot;jobs != null and jobs != &#x27;&#x27;&quot;&gt;</span><br><span class="line"> jobs=#&#123;jobs&#125;,</span><br><span class="line">foreach</span><br><span class="line">当有多个相同条件的数据进⾏查询时，可以使⽤foreach进⾏批量查询</span><br><span class="line"> &lt;/if&gt;</span><br><span class="line"> &lt;if test=&quot;phone != null and phone != &#x27;&#x27;&quot;&gt;</span><br><span class="line"> phone=#&#123;phone&#125;</span><br><span class="line"> &lt;/if&gt;</span><br><span class="line"> &lt;/set&gt;</span><br><span class="line"> where id=#&#123;id&#125;</span><br><span class="line"> &lt;/update&gt;</span><br><span class="line"> &lt;select id=&quot;findCustomerByIds&quot; parameterType=&quot;List&quot; resultType=&quot;customer&quot;&gt;</span><br><span class="line"> select * from t_customer where id in</span><br><span class="line"> &lt;foreach collection=&quot;list&quot; item=&quot;id&quot;</span><br><span class="line"> open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt; #&#123;id&#125; &lt;/foreach&gt;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> @Test</span><br><span class="line"> public void findCustomerByIds() &#123;</span><br><span class="line"> SqlSession sqlSession = MyBatisUtils.getSession();</span><br><span class="line"> List&lt;Integer&gt; ids = new ArrayList&lt;&gt;();</span><br><span class="line"> ids.add(21);</span><br><span class="line"> ids.add(110011);</span><br><span class="line"> ids.add(110012);</span><br><span class="line"> ids.add(110013);</span><br><span class="line"> ids.add(110014);</span><br><span class="line"> ids.add(110015);</span><br><span class="line"> ids.add(110016);</span><br><span class="line"> List&lt;Customer&gt; custs =</span><br><span class="line">sqlSession.selectList(&quot;com.lz.xbmu.CustomerMapper.findCustomerByIds&quot;,ids);</span><br><span class="line"> for(Customer c:custs) System.out.println(c);</span><br><span class="line"> sqlSession.close();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>bind<br>MyBatis关联映射<br>⼀对⼀关系<br>⾸先创建两个表，分别是身份证表tb_idcard，和⼈员信息表tb_person<br>项⽬的内容：<br>IdCard.java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findCustomerByName&quot; parameterType=&quot;customer&quot; resultType=&quot;customer&quot;&gt;</span><br><span class="line"> &lt;bind name=&quot;pattern_username&quot; value=&quot;&#x27;%&#x27;+_parameter.getUsername()+&#x27;%&#x27;&quot; /&gt;</span><br><span class="line"> select * from t_customer where username like #&#123;pattern_username&#125;</span><br><span class="line"> &lt;/select&gt;</span><br></pre></td></tr></table></figure>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> @Test</span><br><span class="line"> public void findCUstomerByName() &#123;</span><br><span class="line"> SqlSession session = MyBatisUtils.getSession();</span><br><span class="line"> Customer cust = new Customer();</span><br><span class="line"> cust.setUsername(&quot;t&quot;);</span><br><span class="line"> List&lt;Customer&gt; custs = session</span><br><span class="line"> .selectList(&quot;com.lz.xbmu.mapper.CustomerMapper.findCustomerByName&quot;,cust);</span><br><span class="line"> for(Customer c:custs)System.out.println(c);</span><br><span class="line"> session.close();</span><br><span class="line"> &#125;</span><br><span class="line">public class IdCard &#123;</span><br><span class="line"> private Integer id;</span><br><span class="line"> private String code;</span><br><span class="line">&#125;</span><br><span class="line">Person.java</span><br><span class="line">public class Person &#123;</span><br><span class="line"> private Integer id;</span><br><span class="line"> private String name;</span><br><span class="line"> private Integer age;</span><br><span class="line"> private String sex;</span><br><span class="line"> private IdCard card;//个⼈关联的身份证</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>IdCardMapper.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.IdCardMapper&quot;&gt;</span><br><span class="line"> &lt;select id=&quot;findCodeById&quot; parameterType=&quot;Integer&quot;</span><br><span class="line"> resultType=&quot;IdCard&quot;&gt;</span><br><span class="line"> select * from tb_idcard where id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line">PersonMapper.xml</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.PersonMapper&quot;&gt;</span><br><span class="line"> &lt;select id=&quot;findPersonById&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultType=&quot;person&quot;&gt;</span><br><span class="line"> select * from tb_person where id=#&#123;id&#125; </span><br><span class="line"> &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line">使⽤嵌套查询时的映射⽂件</span><br><span class="line"> &lt;!-- 嵌套查询 --&gt;</span><br><span class="line"> &lt;select id=&quot;findPersonById&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultMap=&quot;IdCardWithPersonMap&quot;&gt;</span><br><span class="line"> select * from tb_person where id=#&#123;id&#125; </span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;resultMap type=&quot;Person&quot; id=&quot;IdCardWithPersonMap&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;</span><br><span class="line"> &lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;</span><br><span class="line"> &lt;result property=&quot;age&quot; column=&quot;age&quot;/&gt;</span><br><span class="line"> &lt;result property=&quot;sex&quot; column=&quot;sex&quot;/&gt;</span><br><span class="line"> &lt;!-- ⼀对⼀的映射关系 --&gt;</span><br><span class="line"> &lt;association property=&quot;card&quot; column=&quot;card_id&quot;</span><br><span class="line"> javaType=&quot;IdCard&quot;</span><br><span class="line"> select=&quot;com.lz.xbmu.IdCardMapper.findCodeById&quot;&gt;&lt;/association&gt;</span><br><span class="line"> &lt;/resultMap&gt;</span><br><span class="line">嵌套结果</span><br><span class="line"> &lt;!-- 嵌套结果 --&gt;</span><br><span class="line"> &lt;select id=&quot;findPersonById&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultMap=&quot;IdCardWithPersonResult&quot;&gt;</span><br><span class="line"> select * from tb_person p,tb_idcard i where p.id=#&#123;id&#125; and p.card_id=i.id</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;resultMap type=&quot;person&quot; id=&quot;IdCardWithPersonResult&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;</span><br><span class="line"> &lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;</span><br><span class="line"> &lt;result property=&quot;age&quot; column=&quot;age&quot;/&gt;</span><br><span class="line"> &lt;result property=&quot;sex&quot; column=&quot;sex&quot;/&gt;</span><br><span class="line"> &lt;!-- ⼀对⼀的映射关系 --&gt;</span><br><span class="line"> &lt;association property=&quot;card&quot; javaType=&quot;IdCard&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;card_id&quot;/&gt;</span><br><span class="line"> &lt;result property=&quot;code&quot; column=&quot;code&quot;/&gt;</span><br><span class="line"> &lt;/association&gt;</span><br><span class="line"> &lt;/resultMap&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.test;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">import com.lz.xbmu.po.Person;</span><br><span class="line">import com.lz.xbmu.util.MyBatisUtils;</span><br><span class="line">public class PersonCardTest &#123;</span><br><span class="line"> </span><br><span class="line"> @Test</span><br><span class="line"> public void findPersonById() &#123;</span><br><span class="line">⼀对多关系</span><br><span class="line">tb_user</span><br><span class="line">tb_orders</span><br><span class="line">User.java</span><br><span class="line">Orders.java</span><br><span class="line">嵌套查询</span><br><span class="line"> SqlSession session = MyBatisUtils.getSession();</span><br><span class="line"> Person person = session.selectOne(&quot;com.lz.xbmu.PersonMapper.findPersonById&quot;,1);</span><br><span class="line"> System.out.println(person);</span><br><span class="line"> session.close();</span><br><span class="line"> &#125; &#125;</span><br><span class="line">public class User &#123;</span><br><span class="line"> private Integer id;</span><br><span class="line"> private String username;</span><br><span class="line"> private String address;</span><br><span class="line"> private List&lt;Orders&gt; orderList;//⽤户关联的订单</span><br><span class="line">&#125;</span><br><span class="line">public class Orders &#123;</span><br><span class="line"> private Integer id;</span><br><span class="line"> private String number;//订单编号</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试程序代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.OrdersMapper&quot;&gt;</span><br><span class="line"> &lt;select id=&quot;findOrdersById&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultType=&quot;Orders&quot;&gt;</span><br><span class="line"> select * from tb_orders where user_id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.UserMapper&quot;&gt;</span><br><span class="line"> &lt;!-- ⼀对多关系映射 --&gt;</span><br><span class="line"> &lt;select id=&quot;findUserWithOrders&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultMap=&quot;UserWithOrdersMap&quot;&gt;</span><br><span class="line"> select * from tb_user where id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;resultMap type=&quot;user&quot; id=&quot;UserWithOrdersMap&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;username&quot; column=&quot;username&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;address&quot; column=&quot;address&quot; /&gt;</span><br><span class="line"> &lt;collection property=&quot;orderList&quot; column=&quot;id&quot;</span><br><span class="line"> ofType=&quot;Orders&quot;</span><br><span class="line"> select=&quot;com.lz.xbmu.OrdersMapper.findOrdersById&quot;&gt;&lt;/collection&gt;</span><br><span class="line"> &lt;/resultMap&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line">嵌套结果</span><br><span class="line"> &lt;!-- ⼀对多关系映射 --&gt;</span><br><span class="line"> &lt;!-- 嵌套结果 --&gt;</span><br><span class="line"> &lt;select id=&quot;findUserWithOrders&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultMap=&quot;UserWithOrdersResult&quot;&gt;</span><br><span class="line"> select u.*,o.id as orders_id,o.number</span><br><span class="line"> from tb_user u, tb_orders o</span><br><span class="line"> where u.id=#&#123;id&#125; and u.id=o.user_id</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;resultMap type=&quot;user&quot; id=&quot;UserWithOrdersResult&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;username&quot; column=&quot;username&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;address&quot; column=&quot;address&quot; /&gt;</span><br><span class="line"> &lt;collection property=&quot;orderList&quot; ofType=&quot;Orders&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;orders_id&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;number&quot; column=&quot;number&quot;/&gt;</span><br></pre></td></tr></table></figure>

<p>多对多关系<br>tb_product<br>tb_ordersitem<br>tb_ordersitem<br>⾸先在数据中分析清楚多对多的关系<br>分步查询<br>select * from tb_orders where id=1;<br>select * from tb_ordersitem where orders_id=1;<br>select * from tb_product where id in (1,2);<br>综合查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select o.id,o.number,o.user_id,p.name,p.price from tb_orders o,tb_product p,tb_ordersitem i where</span><br><span class="line">o.id=i.orders_id and p.id=i.product_id;</span><br><span class="line"> &lt;/collection&gt;</span><br><span class="line"> &lt;/resultMap&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.po;</span><br><span class="line">import java.util.List;</span><br><span class="line">public class Product &#123;</span><br><span class="line"> private Integer id;</span><br><span class="line"> private String name;</span><br><span class="line"> private Double price;</span><br><span class="line"> private List&lt;Orders&gt; orders;//与订单关联的属性</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">public class Orders &#123;</span><br><span class="line"> private Integer id;</span><br><span class="line"> private String number;//订单编号</span><br><span class="line"> private List&lt;Product&gt; productList;//关联商品集合信息</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多对多嵌套查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.OrdersMapper&quot;&gt;</span><br><span class="line"> &lt;!-- 多对多嵌套查询 --&gt;</span><br><span class="line"> &lt;select id=&quot;findOrdersWithProduct&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultMap=&quot;findOrdersWithProductMap&quot;&gt;</span><br><span class="line"> select * from tb_orders where id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;resultMap type=&quot;orders&quot; id=&quot;findOrdersWithProductMap&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;number&quot; column=&quot;number&quot; /&gt;</span><br><span class="line"> &lt;collection property=&quot;productList&quot; column=&quot;id&quot;</span><br><span class="line"> ofType=&quot;Product&quot;</span><br><span class="line"> select=&quot;com.lz.xbmu.ProductMapper.findProductByOrdersId&quot;&gt;&lt;/collection&gt;</span><br><span class="line"> &lt;/resultMap&gt;</span><br><span class="line"> &lt;select id=&quot;findOrdersById&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultType=&quot;Orders&quot;&gt;</span><br><span class="line"> select * from tb_orders where user_id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.ProductMapper&quot;&gt;</span><br><span class="line"> &lt;!-- 根据订单id来查找相关的产品 --&gt;</span><br><span class="line"> &lt;select id=&quot;findProductByOrdersId&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultType=&quot;product&quot;&gt;</span><br><span class="line"> select * from tb_product</span><br><span class="line"> where id in</span><br><span class="line"> (select product_id from tb_ordersitem where orders_id=#&#123;id&#125;);</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;!-- 根据产品id查找产品 --&gt;</span><br><span class="line"> &lt;select id=&quot;findProductById&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultType=&quot;product&quot;&gt;</span><br><span class="line"> select * from tb_product where id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.test;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.junit.Test;</span><br><span class="line">import com.lz.xbmu.po.Orders;</span><br><span class="line">import com.lz.xbmu.util.MyBatisUtils;</span><br><span class="line">public class OrdersProductTest &#123;</span><br><span class="line"> @Test</span><br><span class="line"> public void findOrdersWithProduct() &#123;</span><br><span class="line"> SqlSession session = MyBatisUtils.getSession();</span><br><span class="line"> Orders orders = session.selectOne(&quot;com.lz.xbmu.OrdersMapper.findOrdersWithProduct&quot;,1);</span><br><span class="line"> System.out.println(orders);</span><br><span class="line"> session.close();</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>多对多的嵌套结果查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.OrdersMapper&quot;&gt;</span><br><span class="line"> &lt;!-- 多对多嵌套结果 --&gt;</span><br><span class="line"> &lt;select id=&quot;findOrdersWithProduct&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultMap=&quot;findOrdersWithProductResult&quot;&gt;</span><br><span class="line"> select o.id,o.number,p.id as product_id,p.name,p.price</span><br><span class="line"> from tb_orders o,tb_product p,tb_ordersitem i</span><br></pre></td></tr></table></figure>

<p>四、Spring整合Mybatis<br>1.搭建环境<br>框架的整合过程，就是将Spring及MyBatis的包导⼊到项⽬中，并且还需要将⼀个专⻔的包导⼊。这个专⻔的包就<br>是⽤于整合Spring及MyBatis的包，因为Spring的发布要先于或是快于MyBatis的版本，所以这个包⼀般情况下是<br>由MyBatis来提供的。<br>⼀般情况下的名称为mybatis-spring.xxxx.jar这个样式的jar包。<br>Spring框架中⽤到的包有：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">where o.id=i.orders_id and p.id=i.product_id and o.id=#&#123;id&#125;;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;resultMap type=&quot;orders&quot; id=&quot;findOrdersWithProductResult&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;number&quot; column=&quot;number&quot; /&gt;</span><br><span class="line"> &lt;collection property=&quot;productList&quot; ofType=&quot;Product&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;product_id&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;</span><br><span class="line"> &lt;result property=&quot;price&quot; column=&quot;price&quot;/&gt;</span><br><span class="line"> &lt;/collection&gt;</span><br><span class="line"> &lt;/resultMap&gt;</span><br><span class="line"> &lt;!-- 多对多嵌套查询 --&gt;</span><br><span class="line"> &lt;select id=&quot;findOrdersWithProduct1&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultMap=&quot;findOrdersWithProductMap&quot;&gt;</span><br><span class="line"> select * from tb_orders where id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> &lt;resultMap type=&quot;orders&quot; id=&quot;findOrdersWithProductMap&quot;&gt;</span><br><span class="line"> &lt;id property=&quot;id&quot; column=&quot;id&quot; /&gt;</span><br><span class="line"> &lt;result property=&quot;number&quot; column=&quot;number&quot; /&gt;</span><br><span class="line"> &lt;collection property=&quot;productList&quot; column=&quot;id&quot;</span><br><span class="line"> ofType=&quot;Product&quot;</span><br><span class="line"> select=&quot;com.lz.xbmu.ProductMapper.findProductByOrdersId&quot;&gt;&lt;/collection&gt;</span><br><span class="line"> &lt;/resultMap&gt;</span><br><span class="line"> &lt;select id=&quot;findOrdersById&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultType=&quot;Orders&quot;&gt;</span><br><span class="line"> select * from tb_orders where user_id=#&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>
<p>spring-aop-5.2.19.RELEASE.jar<br>spring-aspects-5.2.19.RELEASE.jar<br>spring-beans-5.2.19.RELEASE.jar<br>spring-context-5.2.19.RELEASE.jar<br>spring-core-5.2.19.RELEASE.jar<br>spring-expression-5.2.19.RELEASE.jar<br>spring-jdbc-5.2.19.RELEASE.jar<br>spring-tx-5.2.19.RELEASE.jar<br>因为spring的aop使⽤了外部的框架技术，所以还要导⼊aspectjweaver</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line"> &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</span><br><span class="line"> &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;</span><br><span class="line"> &lt;version&gt;1.9.8&lt;/version&gt;</span><br><span class="line"> &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>MyBatis框架中⽤到的包有：<br>commons-logging-1.2.jar<br>log4j-1.2.17.jar<br>log4j-api-2.17.0.jar<br>mybatis-3.5.9.jar<br>Spring整合MyBatis的包：<br>该包可以去Please Wait… | Cloudflare (mvnrepository.com)这个⽹站下载<br>使⽤maven管理项⽬的可以参考:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis-spring --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line"> &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line"> &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;</span><br><span class="line"> &lt;version&gt;2.0.7&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>mybatis-spring-2.0.7.jar<br>数据库的驱动包<br>mysql-connector-java-8.0.28.jar<br>数据源及数据连接池相关包<br>可以到Apache⽹站下载：Welcome to The Apache Software Foundation!<br>commons-dbcp2-2.9.0.jar<br>commons-pool2-2.11.1.jar<br>到这⾥就完成了所包的导⼊⼯作。<br>这⾥只是对Spring和MyBatis进⾏整合，并不涉及SpringMVC技术，所以没有导⼊SpringMVC相关的包。<br>将以上的包添加到开发环境的路径中去。<br>2.编写配置⽂件<br>在类的根路径下创建db.properties⽂件，并配置如下内容。<br>db.properties</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">applicationContext.xml</span><br><span class="line">jdbc.driver=com.mysql.cj.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://localhost:3306/mybatis</span><br><span class="line">jdbc.username=root</span><br><span class="line">jdbc.password=mysqlroot</span><br><span class="line">jdbc.maxTotal=20</span><br><span class="line">jdbc.maxIdle=10</span><br><span class="line">jdbc.initialSize=5</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line"> xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"> xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line"> xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line"> xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line"> https://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line"> http://www.springframework.org/schema/context</span><br><span class="line"> https://www.springframework.org/schema/context/spring-context.xsd</span><br><span class="line"> http://www.springframework.org/schema/tx</span><br><span class="line"> https://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt;</span><br><span class="line"> </span><br><span class="line"> &lt;!-- 读取数据配置⽂件 db.properties --&gt;</span><br><span class="line"> &lt;context:property-placeholder location=&quot;classpath:db.properties&quot;/&gt;</span><br><span class="line"> &lt;!-- 配置数据源 --&gt;</span><br><span class="line"> &lt;bean id=&quot;dataSource&quot;</span><br><span class="line"> class=&quot;org.apache.commons.dbcp2.BasicDataSource&quot;&gt;</span><br><span class="line"> &lt;!-- 数据库驱动 --&gt;</span><br><span class="line"> &lt;property name=&quot;driverClassName&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt;</span><br><span class="line"> &lt;!-- 连接数据库url --&gt;</span><br><span class="line"> &lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc.url&#125;&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;!-- 数据库访问名称 --&gt;</span><br><span class="line"> &lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc.username&#125;&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;!-- 数据库访问密码 --&gt;</span><br><span class="line"> &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;!-- 最⼤连接数 --&gt;</span><br><span class="line"> &lt;property name=&quot;maxTotal&quot; value=&quot;$&#123;jdbc.maxTotal&#125;&quot;/&gt;</span><br><span class="line"> &lt;!-- 最⼤空闲数 --&gt;</span><br><span class="line"> &lt;property name=&quot;maxIdle&quot; value=&quot;$&#123;jdbc.maxIdle&#125;&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;!-- 初始化连接数 --&gt;</span><br><span class="line"> &lt;property name=&quot;initialSize&quot; value=&quot;$&#123;jdbc.initialSize&#125;&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line"> &lt;!-- 事务管理器，依赖于数据源 --&gt;</span><br><span class="line"> &lt;bean id=&quot;transactionManager&quot;</span><br><span class="line"> class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;</span><br><span class="line"> &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line"> &lt;!-- 开启事务注解 --&gt;</span><br><span class="line"> &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;</span><br><span class="line"> &lt;!-- 配置MyBatis⼯⼚ --&gt;</span><br><span class="line"> &lt;bean id=&quot;sqlSessionFactory&quot;</span><br><span class="line"> class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;</span><br><span class="line"> &lt;!-- 注⼊数据源 --&gt;</span><br><span class="line"> &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;!-- 指定核⼼配置⽂件的位置 --&gt;</span><br><span class="line"> &lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis-config.xml&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line"> &lt;!-- Mapper代理开发（基于MapperFactoryBean） --&gt;</span><br><span class="line"> &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;</span><br><span class="line"> &lt;property name=&quot;basePackage&quot; value=&quot;com.lz.xbmu.mapper&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>mybatis-config.xml<br>log4j.properties<br>3.使⽤Mapper的⽅式开发<br>这⾥需要在Sprng的配置⽂件中进⾏修改，来实现通过mapper的定义接⼝来调⽤相关的⽅法。<br>4.事务及分层</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line"> &lt;!-- 配置别名 --&gt;</span><br><span class="line"> &lt;typeAliases&gt;</span><br><span class="line"> &lt;package name=&quot;com.lz.xbmu.po&quot;/&gt;</span><br><span class="line"> &lt;/typeAliases&gt;</span><br><span class="line"> &lt;mappers&gt;</span><br><span class="line"> &lt;mapper resource=&quot;com/lz/xbmu/mapper/CustomerMapper.xml&quot;/&gt;</span><br><span class="line"> &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">log4j.rootLogger=ERROR, stdout</span><br><span class="line">log4j.logger.com.lz.xbmu=DEBUG</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Mapper代理开发 --&gt;</span><br><span class="line"> &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;</span><br><span class="line"> &lt;property name=&quot;basePackage&quot; value=&quot;com.lz.xbmu.mapper&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line">当使⽤了代理模式后，mybatis-config.xml</span><br><span class="line">可以修改为包扫描的⽅式。</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line"> &lt;!-- 配置别名 --&gt;</span><br><span class="line"> &lt;typeAliases&gt;</span><br><span class="line"> &lt;package name=&quot;com.lz.xbmu.po&quot;/&gt;</span><br><span class="line"> &lt;/typeAliases&gt;</span><br><span class="line"> &lt;mappers&gt;</span><br><span class="line"> &lt;!-- &lt;mapper resource=&quot;com/lz/xbmu/mapper/CustomerMapper.xml&quot;/&gt; --&gt;</span><br><span class="line"> &lt;package name=&quot;com.lz.xbmu.mapper&quot;/&gt;</span><br><span class="line"> &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<p>应⽤案例全过程：<br>1.创建Customer.java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">com.lz.xbmu.po</span><br><span class="line">public class Customer &#123;</span><br><span class="line"> private Integer id;</span><br><span class="line"> private String username;</span><br><span class="line"> private String jobs;</span><br><span class="line"> private String phone;</span><br><span class="line"> //getter setter⽅法略</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">com.lz.xbmu.mapper.CustomerMapper.java</span><br><span class="line">package com.lz.xbmu.mapper;</span><br><span class="line">import com.lz.xbmu.po.Customer;</span><br><span class="line">public interface CustomerMapper &#123;</span><br><span class="line"> public Customer findCustomerById(int id);</span><br><span class="line"> public int addCustomer(Customer cust);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>com.lz.xbmu.mapper.CustomerMapper.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line"> PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line"> &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.lz.xbmu.mapper.CustomerMapper&quot;&gt;</span><br><span class="line"> &lt;select id=&quot;findCustomerById&quot; parameterType=&quot;int&quot;</span><br><span class="line"> resultType=&quot;customer&quot;&gt;</span><br><span class="line"> select * from t_customer where id = #&#123;id&#125;</span><br><span class="line"> &lt;/select&gt;</span><br><span class="line"> </span><br><span class="line"> &lt;insert id=&quot;addCustomer&quot; parameterType=&quot;customer&quot;&gt;</span><br><span class="line"> insert into t_customer values (null,#&#123;username&#125;,#&#123;jobs&#125;,#&#123;phone&#125;)</span><br><span class="line"> &lt;/insert&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

<p>com.lz.xbmu.service.CustomerService</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.service;</span><br><span class="line">import com.lz.xbmu.po.Customer;</span><br><span class="line">public interface CustomerService &#123;</span><br><span class="line"> public Customer findCustomerById(int id);</span><br><span class="line"> public int addCustomer(Customer cust);</span><br><span class="line">&#125;</span><br><span class="line">com.lz.xbmu.service.impl.CustomerServiceImpl</span><br><span class="line">package com.lz.xbmu.service.impl;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line">import com.lz.xbmu.mapper.CustomerMapper;</span><br><span class="line">import com.lz.xbmu.po.Customer;</span><br><span class="line">import com.lz.xbmu.service.CustomerService;</span><br><span class="line">@Service</span><br><span class="line">public class CustomerServiceImpl implements CustomerService &#123;</span><br><span class="line"> @Autowired</span><br><span class="line"> private CustomerMapper customerMapper;</span><br><span class="line"> </span><br><span class="line"> @Override</span><br><span class="line"> public Customer findCustomerById(int id) &#123;</span><br><span class="line"> // TODO Auto-generated method stub</span><br><span class="line"> return this.customerMapper.findCustomerById(id);</span><br><span class="line"> &#125;</span><br><span class="line"> @Override</span><br><span class="line"> public int addCustomer(Customer cust) &#123;</span><br><span class="line"> // TODO Auto-generated method stub</span><br><span class="line"> return this.customerMapper.addCustomer(cust);</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>com.lz.xbmu.controller.CustomerController</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.controller;</span><br><span class="line">import org.springframework.context.ApplicationContext;</span><br><span class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import com.lz.xbmu.po.Customer;</span><br><span class="line">import com.lz.xbmu.service.CustomerService;</span><br><span class="line">@Controller</span><br><span class="line">public class CustomerController &#123;</span><br><span class="line"> </span><br><span class="line"> public static void main(String[] args) &#123;</span><br><span class="line"> ApplicationContext cxt = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</span><br><span class="line"> CustomerService cs = cxt.getBean(CustomerService.class);</span><br><span class="line">// Customer cust = cs.findCustomerById(110020);</span><br><span class="line">// System.out.println(cust);</span><br><span class="line"> Customer cust = new Customer();</span><br><span class="line"> cust.setUsername(&quot;Test02&quot;);</span><br><span class="line"> cust.setJobs(&quot;test02&quot;);</span><br><span class="line"> cust.setPhone(&quot;test02&quot;);</span><br><span class="line"> int result = cs.addCustomer(cust);</span><br><span class="line"> System.out.println(result);</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>项⽬案例的结构图：<br>五、SpringMVC⽂件上传与下载<br>1.新建项⽬Dynamic Web Project<br>选择新建项⽬类型为Dynamic Web Project<br>指定相关的项⽬参数<br>2.导⼊相关的包<br>将以下的jar包拷⻉到项⽬中WEB-INF⽬录下的lib⽬录下<br>commons-fileupload-1.4.jar<br>commons-io-2.11.0.jar<br>commons-logging-1.2.jar<br>javax.servlet-api-3.1.0.jar<br>spring-aop-5.2.19.RELEASE.jar<br>spring-beans-5.2.9.RELEASE.jar<br>spring-context-5.2.9.RELEASE.jar<br>spring-core-5.2.9.RELEASE.jar<br>spring-expression-5.2.9.RELEASE.jar<br>spring-web-5.2.19.RELEASE.jar<br>spring-webmvc-5.2.19.RELEASE.jar<br>将以上的包添加到环境变量中<br>3.创建⽂件上传⻚⾯<br>在webapp⽬录下创建jsp⻚⾯<br>&lt;%@ page language=”java” contentType=”text/html; charset=UTF-8”<br> pageEncoding=”UTF-8”%&gt;<br><!DOCTYPE html><br>4.新建配置⽂件并进⾏配置<br>web.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt; &lt;body&gt; &lt;div style=&quot;margin: auto;border: #000000 1px solid; width: 400px; height: 220px;&quot;&gt; &lt;h3&gt;图⽚上传&lt;/h3&gt; &lt;form action=&quot;/fileUpload&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt; &lt;label&gt;上传者名称&lt;/label&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;&lt;br /&gt;</span><br><span class="line">&lt;input type=&quot;file&quot; name=&quot;uploadfile&quot; multiple=&quot;multiple&quot;/&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; value=&quot;上传&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"> xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span><br><span class="line"> xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee</span><br><span class="line">http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span><br><span class="line"> id=&quot;WebApp_ID&quot; version=&quot;3.1&quot;&gt;</span><br><span class="line"> &lt;display-name&gt;FileUploadDemo02&lt;/display-name&gt;</span><br><span class="line"> &lt;servlet&gt;</span><br><span class="line"> &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;</span><br><span class="line"> &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;</span><br><span class="line"> &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line"> &lt;/servlet&gt;</span><br><span class="line"> &lt;servlet-mapping&gt;</span><br><span class="line"> &lt;servlet-name&gt;default&lt;/servlet-name&gt;</span><br><span class="line"> &lt;url-pattern&gt;*.jpg&lt;/url-pattern&gt;</span><br><span class="line"> &lt;/servlet-mapping&gt;</span><br><span class="line"> &lt;servlet-mapping&gt;</span><br><span class="line"> &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;</span><br><span class="line"> &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span><br><span class="line"> &lt;/servlet-mapping&gt;</span><br><span class="line">&lt;/web-app&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line"> xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">5.编写代码controller</span><br><span class="line"> xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line"> xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;</span><br><span class="line"> xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans</span><br><span class="line"> https://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line"> http://www.springframework.org/schema/context</span><br><span class="line"> https://www.springframework.org/schema/context/spring-context.xsd</span><br><span class="line"> http://www.springframework.org/schema/mvc</span><br><span class="line"> https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt;</span><br><span class="line"> &lt;!-- 启⽤注解的⽅式 --&gt;</span><br><span class="line"> &lt;context:annotation-config /&gt;</span><br><span class="line"> &lt;!-- 使⽤包扫描的⽅式 --&gt;</span><br><span class="line"> &lt;context:component-scan</span><br><span class="line"> base-package=&quot;com.lz.xbmu.controller&quot; /&gt;</span><br><span class="line"> &lt;!-- 配置视图解析器 --&gt;</span><br><span class="line"> &lt;bean id=&quot;viewResolver&quot;</span><br><span class="line"> class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;</span><br><span class="line"> &lt;!-- 前缀 --&gt;</span><br><span class="line"> &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/jsp/&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;!-- 后缀 --&gt;</span><br><span class="line"> &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line"> &lt;!-- mvc的注解驱动 --&gt;</span><br><span class="line"> &lt;mvc:annotation-driven /&gt;</span><br><span class="line"> &lt;!-- 配置⽂件上传解析器 MultipartResolver --&gt;</span><br><span class="line"> &lt;bean id=&quot;multipartResolver&quot;</span><br><span class="line"> class=&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;&gt;</span><br><span class="line"> &lt;!-- 设置请求编码格式 --&gt;</span><br><span class="line"> &lt;property name=&quot;defaultEncoding&quot; value=&quot;UTF-8&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;property name=&quot;maxUploadSize&quot; value=&quot;2097152&quot;&gt;&lt;/property&gt;</span><br><span class="line"> &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<p>package com.lz.xbmu.controller;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import java.io.File;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.UUID;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line">import org.springframework.web.multipart.MultipartFile;</span><br><span class="line">import org.springframework.web.servlet.ModelAndView;</span><br><span class="line">@Controller</span><br><span class="line">public class BookPictureController &#123;</span><br><span class="line"> @PostMapping(&quot;/fileUpload&quot;)</span><br><span class="line"> public ModelAndView fileUpload(@RequestParam(&quot;name&quot;) String name,</span><br><span class="line"> @RequestParam(&quot;file&quot;) List&lt;MultipartFile&gt; uploadfile,</span><br><span class="line"> HttpServletRequest request,ModelAndView mav) &#123;</span><br><span class="line"> System.out.println(&quot;name=&quot;+name);</span><br><span class="line"> System.out.println(&quot;file=&quot;+uploadfile);</span><br><span class="line"> //判断⽂件是否为空</span><br><span class="line"> if (!uploadfile.isEmpty() &amp;&amp; uploadfile.size() &gt; 0) &#123;</span><br><span class="line"> //循环输出上传⽂件</span><br><span class="line"> for (MultipartFile file : uploadfile) &#123;</span><br><span class="line"> //获取⽂件名</span><br><span class="line"> String originalFilename = file.getOriginalFilename();</span><br><span class="line"> //设置上传⽂件的保存地址⽬录</span><br><span class="line"> String dirPath = request.getServletContext().getRealPath(&quot;/upload/&quot;);</span><br><span class="line"> File filePath = new File(dirPath);</span><br><span class="line"> //如果保存⽂件⽬录不存在，就创建</span><br><span class="line"> if(!filePath.exists()) &#123;</span><br><span class="line"> filePath.mkdirs();</span><br><span class="line"> &#125;</span><br><span class="line"> //给上传的⽂件重新命名</span><br><span class="line"> String newFilename = name + &quot;_&quot; + UUID.randomUUID() + &quot;_&quot; + originalFilename;</span><br><span class="line"> try &#123;</span><br><span class="line"> //使⽤MultipartFile接⼝中的⽅法完成⽂件的上传</span><br><span class="line"> file.transferTo(new File(dirPath + newFilename));</span><br><span class="line"> &#125; catch (Exception e) &#123;</span><br><span class="line"> e.printStackTrace();</span><br><span class="line"> mav.setViewName(&quot;error&quot;);</span><br><span class="line"> &#125;</span><br><span class="line"> //这⾥演示的是将⼀张图⽚名保存</span><br><span class="line"> mav.addObject(&quot;info&quot;,newFilename);</span><br><span class="line"> &#125;</span><br><span class="line"> mav.setViewName(&quot;success&quot;);</span><br><span class="line"> &#125; else &#123;</span><br><span class="line"> mav.setViewName(&quot;error&quot;);</span><br><span class="line"> &#125;</span><br><span class="line"> return mav;</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>⽂件下载的实现（防⽌中⽂乱码，进⾏统⼀编码）<br>下载⻚⾯的设置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line"> pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%@ page import=&quot;java.net.URLEncoder&quot; %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt; &lt;body&gt; &lt;h2&gt;⽂件下载应⽤&lt;/h2&gt; &lt;a href=&quot;$&#123;pageContext.request.contextPath &#125;/downloadfile?filename=&lt;%=URLEncoder.encode(&quot;宇航</span><br><span class="line">员.jpeg&quot;,&quot;UTF-8&quot;) %&gt;&quot;&gt;</span><br><span class="line">下载⽂件</span><br><span class="line">&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>请求处理的Controller</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">package com.lz.xbmu.controller;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.UnsupportedEncodingException;</span><br><span class="line">import java.net.URLEncoder;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import org.apache.commons.io.FileUtils;</span><br><span class="line">import org.springframework.http.HttpHeaders;</span><br><span class="line">import org.springframework.http.HttpStatus;</span><br><span class="line">import org.springframework.http.MediaType;</span><br><span class="line">import org.springframework.http.ResponseEntity;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">@Controller</span><br><span class="line">public class FileDownloadController &#123;</span><br><span class="line"> @RequestMapping(&quot;/downloadfile&quot;)</span><br><span class="line"> public ResponseEntity&lt;byte[]&gt; fileDownload(String filename,HttpServletRequest request)</span><br><span class="line"> throws IOException&#123;</span><br><span class="line"> //指定要下载的⽂件的路径</span><br><span class="line"> String path = request.getServletContext().getRealPath(&quot;/upload/&quot;);</span><br><span class="line"> //创建下载⽂件对象</span><br><span class="line"> File file = new File(path + File.separator + filename);</span><br><span class="line"> //对⽂件名编码，防⽌中⽂乱码</span><br><span class="line"> filename = this.getFilename(request,filename);</span><br><span class="line"> //设置响应头</span><br><span class="line"> HttpHeaders headers = new HttpHeaders();</span><br><span class="line"> headers.setContentDispositionFormData(&quot;attachment&quot;, filename);</span><br><span class="line"> //定义以流的形式下载返回⽂件数据</span><br><span class="line"> headers.setContentType(MediaType.APPLICATION_OCTET_STREAM);</span><br><span class="line"> //使⽤SpringMVC框架的对象封装返回下载的数据</span><br><span class="line"> return new ResponseEntity&lt;byte[]&gt;(FileUtils.readFileToByteArray(file),</span><br><span class="line"> headers,HttpStatus.OK);</span><br><span class="line"> &#125;</span><br><span class="line"> private String getFilename(HttpServletRequest request, String filename)</span><br><span class="line"> throws UnsupportedEncodingException &#123;</span><br><span class="line"> //根据不同浏览器来判断</span><br><span class="line"> String[] IEBrowserKeyWords = &#123;&quot;MSIE&quot;,&quot;Trident&quot;,&quot;Edge&quot;&#125;;</span><br><span class="line"> //获取请求头代理信息</span><br><span class="line"> String userAgent = request.getHeader(&quot;User-Agent&quot;);</span><br><span class="line"> for (String keyWord : IEBrowserKeyWords) &#123;</span><br><span class="line"> if(userAgent.contains(keyWord)) &#123;</span><br><span class="line"> //进⾏统⼀编码</span><br><span class="line"> return URLEncoder.encode(filename,&quot;UTF-8&quot;);</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> //其它的浏览器统⼀为ISO-8859-1编码显示</span><br><span class="line"> return new String(filename.getBytes(&quot;UTF-8&quot;),&quot;ISO-8859-1&quot;);</span><br><span class="line"> &#125; &#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
    
    <div>
      
         <div>
	
		<div style="text-align:center;color:#bfbfbf;font-size:16px;"> 
 		<span>-------- 本文结束 </span> 
 		<i class="fa fa-paw"></i> 
 		<span> 感谢阅读 --------</span>
		</div> 
  	
</div>
      
    </div>

    <footer class="post-footer">
          <div class="reward-container">
  <div></div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="simon·yi an 微信">
        <span>微信</span>
      </div>

  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/11/25/LeetCode102/" rel="prev" title="LeetCode102 二叉树的层序遍历">
                  <i class="fa fa-chevron-left"></i> LeetCode102 二叉树的层序遍历
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/04/23/SSMknowledge/" rel="next" title="基于SSM框架的电⼦书城项⽬开发笔记">
                  基于SSM框架的电⼦书城项⽬开发笔记 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">simon·yi an</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">109k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">1:39</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

  <div class="powered-by">
  <i class="fa fa-user-md"></i>
  <span id="busuanzi_container_site_uv">
    本站总访客数:<span id="busuanzi_value_site_uv"></span>&nbsp;&nbsp;| 
  </span>
  <span id="busuanzi_container_site_pv">
      &nbsp;本站总访问量<span id="busuanzi_value_site_pv"></span>次
  </span>
  </div>
  </div>
<script>
      var now = new Date(); 
      function createtime() { 
          var grt= new Date("03/12/2019 12:00:00");//此处修改你的建站时间或者网站上线时间 
          now.setTime(now.getTime()+250); 
          days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
          if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
          mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
          snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
          document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
          document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
      } 
  setInterval("createtime()",250);
  </script>
    </div>
  </footer>

  
  <script size="300" alpha="0.6" zIndex="-1" src="https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






  <script async src="/js/cursor/fireworks.js"></script>




  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>

</body>
</html>
